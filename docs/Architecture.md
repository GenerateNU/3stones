# Tech Stack

- [Golang](https://go.dev/) is the language we are using for the backend.
- [Fiber](https://gofiber.io/) is the library we are using for route handling, request parsing, response writing, etc.
- [PostgreSQL](https://www.postgresql.org/) is the database we are using for the backend.
- [Supabase](https://supabase.com/) is a SaaS platform that manages PostgreSQL for us.
- [Ent.go](https://entgo.io/) is an entity framework (or ORM) we're using.
- [TypeScript](https://www.typescriptlang.org/) is the language we are using for the frontend.
- [React Native](https://reactnative.dev/) is the mobile UI framework we are using for the frontend.

# Directory structure

- `docs/`: Contains all documentation for the project.
- `config/`: Contains `.env` files used by the backend for configuration.
- `backend/`: Contains all code for the backend.
  - `cmd/`: Entrypoint code for all backend tasks. Packages in this directory should probably only contain a `main.go` file.
    - `server/main.go`: Code to initialize and run the webserver.
    - `reset/main.go`: Code to reset the database.
    - `seed/main.go`: Code to seed the database.
    - `login/main.go`: Code to do a login w/ Supabase auth.
  - `ent/`: Contains code for interacting with the database. Most of this code is generated by `Ent.go` and should not be hand-edited.
      - `schema/`: Contains schema/model defintions that map to the database. Code in this directory is meant to be modified/hand-edited.
  - `internal/`: Contains all internal server code.
    - `auth/`: Code for authentication. Right now this is just the middleware. See `Authentication-Notes.md` for an overview.
    - `routes/`: Contains functions that initialize controllers and creates routes for the webserver.
    - `controllers/`: Contains controllers, which handle request parsing, returning a response, and calling into transactions to do business logic.
    - `transactions/`: Contains functions to handle querying/updating/inserting into the database or any other services/integrations 3stones uses.
    - `types/`: Type defintions used throughout the codebase. Types that are being used for requests and responses of routes should be defined here.
    - `utilties/`: Helper functions used throughout the codebase.
    - `config/`: Type definitions and functions used for parsing `.env` configs.
- `frontend/`: Contains all code for the frontend.
  - `__test__/`: Contains all tests for frontend code.
  - `.expo/`: Setup and configuration files created by expo.
  - `assets/`: Contains images, fonts, etc. needed for the frontend.
  - `constants/`: All constants used in the frontend, such as colors.
  - `node_modules/`: External packages.
  - `src/`: Contains all product code for the frontend.
    - `navigation/`: Code for navigation between screens.
    - `screens/`: Contains the definitions of all screens. Each screen has its own subdirectory which contains the screen definition and styles for the screen.
    - `services/`: Code to interface with services used in the frontend, such as the API.
    - `types/`: Type definitions.
  - `App.js`: The main entrypoint for running the frontend.
  - All of the other files are configuration files.

# Using Ent.go

Ent.go is an ORM that relies heavily on code generation: rather than writing SQL scripts and Go code to manually create database tables, we define our model in `ent/schema/` and run a command to write this code for us. You should familiarize yourself with Ent.go, with its [Getting Started page](https://entgo.io/docs/getting-started), the [Schema section](https://entgo.io/docs/schema-def), and [Code Generation section](https://entgo.io/docs/code-gen).

Lastly, keep in mind that new model definitions can be created with `go run -mod=mod entgo.io/ent/cmd/ent new MODEL_NAME`, and that when you are done creating/updating/deleting a model definition, to run `go generate ./ent` to reflect these changes. Make sure these commands are run in the `backend` directory.
